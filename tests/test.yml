---
- name: generic tests for all the roles
  hosts: all
  vars:
    ansible_python_interpreter: /usr/bin/python3
    domains:
      - cname: mail.example.org
  roles:
    # - {role: ../roles/apt_dist_upgrade, become: true}
    - {role: ../roles/common, become: true}
    - {role: ../roles/hostname, become: true}
    # The easy ports sequece is just for test. Also don't disable strict IP
    # filtering on production.
    # - {role: ../roles/knockd, ports: [3333, 4444, 5555], network_interface: eth1, filter_ip: ""}
    - {role: ../roles/nftables}
    - {role: ../roles/ssh}
    - {role: ../roles/fail2ban}
    - {role: ../roles/snake_oil_dehydrated}
    - {role: ../roles/mailserver}
    - {role: ../roles/weechat}
    # Uncomment to test wikijs role: it's commented since the tarball that we
    # have to download is more than 60MB.
    # - {role: ../roles/wikijs, become: true, wikijs_db_type: sqlite}
    - {role: ../roles/adguardhome}
